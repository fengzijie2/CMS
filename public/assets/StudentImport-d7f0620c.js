import{r as y,_ as j,a as r,u as A,o as h,c as E,b as e,w as t,e as n,g as d,D as O,h as S,t as $,H as F,l as H,p as M,i as G}from"./index-d4928f24.js";import{v as J}from"./el-loading-c2d4e084.js";import{E as K}from"./el-dialog-9b126435.js";import{f as Q,e as W,g as X,h as Y}from"./el-overlay-19620d0a.js";import{E as Z}from"./el-card-2a920598.js";import"./el-input-8b980146.js";import{E as ee}from"./el-progress-b366bfee.js";import{a as te,E as oe}from"./el-collapse-item-326461e2.js";import"./event-9519ab40.js";import"./strings-87eb2823.js";import"./cloneDeep-1213d855.js";import"./_baseClone-652de094.js";import"./castArray-ae0f5a93.js";import"./rand-14326ce1.js";function ae(){return y({url:"/api/import/downloadTemplate",method:"get",responseType:"blob"})}function le(p){return y({url:"/api/import/importResultList",method:"get",params:p})}const c=p=>(M("data-v-0972c4df"),p=p(),G(),p),se={class:"import-student-container"},ne={class:"import-instruction"},ie=c(()=>n("span",{class:"title"},"导入说明",-1)),re={class:"content"},pe=c(()=>n("li",null,"1.导入前请先下载相应的模板，严格按照模板规则进行数据输入",-1)),de=c(()=>n("li",null,"2.只支持excel文件, 文件大小要求在2M以内",-1)),ue=c(()=>n("li",null,"3.在本页面导入学员，学员会进入学员管理模块",-1)),ce={class:"import-excel"},me=c(()=>n("div",{class:"el-upload__tip"},"只允许上传1个文件",-1)),_e={key:1},fe={class:"dialog-footer"},he={__name:"StudentImport",setup(p){const g=r("1"),m=r(),C=async()=>{const{data:l}=await ae(),a=URL.createObjectURL(l),i=document.createElement("a");i.href=a,i.download="模板.xlsx",i.click()},k=l=>{m.value.clearFiles(),m.value.handleStart(l[0])},R=A(),z=r({Authorization:R.token}),D=()=>{m.value.submit()},U=r(!1),v=r([]),u=r({pageNum:1,pageSize:10}),b=r(0),_=async()=>{const{data:l}=await le(u.value);l.code===200&&(b.value=l.total,v.value=l.data)};_();const f=r(!1),w=r([]),V=l=>{f.value=!0,w.value=l};return(l,a)=>{const i=H,I=te,T=oe,L=ee,s=W,x=X,N=Y,B=Z,q=K,P=J;return h(),E("div",se,[e(B,null,{default:t(()=>[n("div",ne,[e(T,{modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=o=>g.value=o)},{default:t(()=>[e(I,{name:"1"},{title:t(()=>[ie]),default:t(()=>[n("ul",re,[pe,de,ue,n("li",null,[e(i,{onClick:C},{default:t(()=>[d("下载模板")]),_:1})])])]),_:1})]),_:1},8,["modelValue"])]),n("div",ce,[e(L,{ref_key:"uploadRef",ref:m,class:"upload-demo",action:"/api/import/studentTable","auto-upload":!1,accept:".xlsx, .xls","with-credentials":!0,headers:z.value,limit:1,"on-exceed":k,"on-success":_},{trigger:t(()=>[e(i,{type:"primary"},{default:t(()=>[d("选择文件")]),_:1})]),tip:t(()=>[me]),default:t(()=>[e(i,{type:"success",onClick:D},{default:t(()=>[d("确定导入")]),_:1})]),_:1},8,["headers"])]),O((h(),S(x,{class:"import-result-table",data:v.value,style:{width:"100%"},"max-height":"600"},{default:t(()=>[e(s,{prop:"fileName",label:"导入的文件",width:"200"}),e(s,{label:"导入时间",width:"200"},{default:t(({row:o})=>[d($(F(Q)(o.time)),1)]),_:1}),e(s,{prop:"importPeople",label:"操作者",width:"200"}),e(s,{prop:"statusDescription",label:"导入状态",width:"200"}),e(s,{prop:"total",label:"导入总条数",width:"200"}),e(s,{prop:"successCount",label:"成功条数",width:"200"}),e(s,{prop:"defeatCount",label:"失败条数",width:"200"}),e(s,{prop:"importStudentError",label:"查看失败详情",width:"200"},{default:t(({row:o})=>[o.importStudentError.length?(h(),S(i,{key:0,type:"danger",onClick:ge=>V(o.importStudentError)},{default:t(()=>[d(" 详情 ")]),_:2},1032,["onClick"])):(h(),E("span",_e,"无"))]),_:1})]),_:1},8,["data"])),[[P,U.value]]),e(N,{"current-page":u.value.pageNum,"onUpdate:currentPage":a[1]||(a[1]=o=>u.value.pageNum=o),"page-size":u.value.pageSize,"onUpdate:pageSize":a[2]||(a[2]=o=>u.value.pageSize=o),onSizeChange:_,onCurrentChange:_,"page-sizes":[10,20,30,40],"prev-text":"上一页","next-text":"下一页",layout:"total, sizes, prev, pager, next, jumper",total:b.value},null,8,["current-page","page-size","total"])]),_:1}),e(q,{modelValue:f.value,"onUpdate:modelValue":a[4]||(a[4]=o=>f.value=o),title:"失败详情",width:"420"},{footer:t(()=>[n("span",fe,[e(i,{onClick:a[3]||(a[3]=o=>f.value=!1)},{default:t(()=>[d("关闭")]),_:1})])]),default:t(()=>[e(x,{data:w.value,style:{width:"100%"},"max-height":"250"},{default:t(()=>[e(s,{prop:"phone",label:"手机号",width:"200"}),e(s,{prop:"reason",label:"失败原因",width:"200"})]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}},Ie=j(he,[["__scopeId","data-v-0972c4df"]]);export{Ie as default};
